<?xml version="1.0" encoding="UTF-8"?>

<!-- 
  This ant file builds the TableLayout project.  The basedir points to the
  TableLayout directory.
  
  Author: Daniel E. Barbalace
 -->

<project name="projectTableLayout" default="all" basedir="..">

  <!-- Path properties -->
  <property name="dirSource" value="src"/>
  <property name="dirClasses" value="classes"/>
  <property name="dirJavadoc" value="javadoc"/>
  <property name="dirJar" value="jar"/>
  <property name="dirExtensions" value="extensions"/>
  <property name="dirTemp" value="temp"/>
  
  <!-- Cleans all output generated by any target -->
  <target name="clean">
    <delete dir="${dirClasses}"/>
    <delete dir="${dirJavadoc}"/>
    <delete dir="${dirJar}"/>
  </target>
  
  <!-- Creates the essential output directories -->
  <target name="setup">
    <mkdir dir="${dirClasses}"/>
    <mkdir dir="${dirJavadoc}"/>
    <mkdir dir="${dirJar}"/>
  </target>
  
  <!-- Builds all TableLayout classes -->
  <target name="buildTableLayout" depends="setup">
    <javac srcdir="${dirSource}" destdir="${dirClasses}"/>
  </target>
  
  <!-- Generates JavaDoc files -->
  <target name="javadoc" depends="setup">
    <javadoc
       sourcepath="${dirSource}"
       destdir="${dirJavadoc}"
       packagenames="info.clearthought.layout.*"
       author="true"
       version="true">
    </javadoc>
  </target>
  
  <!-- Generates the jar files for distribution -->
  <target name="jar" depends="buildTableLayout, javadoc">
    <jar destfile="${dirJar}/TableLayout-src.jar" basedir="${dirSource}"
     includes="info/**"/>
    <jar destfile="${dirJar}/TableLayout-javadoc.jar" basedir="${dirJavadoc}"/>
    <jar destfile="${dirJar}/TableLayout.jar" basedir="${dirClasses}"
     includes="info/**"/>
  </target>
  
  <!-- Builds all extensions -->
  <target name="buildExtensions" depends="jar">
  	<mkdir dir="${dirTemp}"/>
    <javac srcdir="${dirExtensions}" destdir="${dirTemp}"
      classpath="${dirJar}/TableLayout.jar"/>
    <javadoc
       sourcepath="${dirExtensions}"
       destdir="${dirTemp}"
       packagenames="info.clearthought.layout.*"
       author="true"
       version="true">
    </javadoc>
    <copy todir="${dirTemp}">
      <fileset dir="${dirExtensions}"/>
    </copy>
    <jar destfile="${dirJar}/TableLayoutExtensions.jar" basedir="${dirTemp}"
     includes="**"/>
  	<delete dir="${dirTemp}"/>
  </target>
  
  <!-- Builds everything -->
  <target name="all" depends="clean, setup, buildTableLayout, buildExtensions">
  </target>
  
</project>
